<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>LOBE - RESET PASSWORD</title>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"><!--bootstrap file-->
	<link rel="stylesheet" type="text/css" href="css/style.css"><!--Css file-->
	<link rel="stylesheet" type="text/css" href="css/responsive.css"><!--Css file-->
</head>
<body>
	<!-- Sign Up div -->
	<section class="signup-mainbody">

		<div class="forget-paas container" style="display: block">
			<h5>Enter new password</h5>
			<form action="javascript:void(0)">
				<div class="form-group col-sm-3">
     			 	<input id="fp-password" type="text" class="form-control" placeholder="Password" required>
				</div>
				<div class="form-group">
					<button type="submit" id="fp-submit">Submit</button>
				</div>
			</form>
		</div>
	</section>
</body>
<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script><!--JQuery file-->
<script type="text/javascript" src="js/jquery-ui.min.js"></script><!--Jquery UI File-->
<script type="text/javascript" src="js/umd/popper.min.js"></script><!--popper-->
<script type="text/javascript" src="js/bootstrap.min.js"></script><!--bootstrap-->
<script type="text/javascript" src="js/auth.js"></script>
<script type="text/javascript">
	$(document).ready(function () {

		var url = new URL(window.location.href);
		var token = url.searchParams.get("token");

		$.ajax({
			type: 'POST',
			url: basePath+'/api/user/reset-password-validation',
			dataType: 'json',
			data: {'token': token},
			success: function(response){
				console.log(response);
			},
			error: function(error){
				console.log(error.reponseJSON);
				alert("Invalid recovery link");
				location.href='signup.html';
			}
		});

		$('#fp-submit').click(function(){

			var password = $('#fp-password').val();

			$.ajax({
				type: 'POST',
				url: basePath+'/api/user/reset-password',
				dataType: 'json',
				data: {'token': token, 'password':password},
				success: function(response){
					console.log(response);
					alert('Password successfully reset');
					location.href='signup.html';
				},
				error: function(error){
					console.log(error.reponseJSON);
					location.href='signup.html';
				}
			})
		});
	});
</script>
</html>